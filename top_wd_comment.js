javascript:(async function(){const processedEventIndexes=new Set();async function getOpenDate(){const popup=document.querySelector('[data-automation-id="popUpDialog"]');if(popup){const textViews=popup.querySelectorAll('[data-automation-id="textView"]');for(let tv of textViews){if(tv.textContent.match(/^\d{4}-\d{2}-\d{2}$/)){return tv.textContent;}}}return null;}async function processNext(){const events=[...document.querySelectorAll('[data-automation-id="calendarevent"]')];console.log('Hittade',events.length,'events, redan behandlade:',processedEventIndexes.size);for(let i=0;i<events.length;i++){if(processedEventIndexes.has(i)){continue;}const ev=events[i];const title=ev.querySelector('[data-automation-id="calendarAppointmentTitle"]');if(title&&title.textContent.includes('Länsförsäkringar')){console.log('Klickar på event',i);ev.click();await new Promise(r=>setTimeout(r,1500));const dateText=await getOpenDate();console.log('Öppnade datum:',dateText);const ta=document.querySelector('textarea[data-automation-id="textAreaField"]');if(ta){console.log('Textarea värde:"'+ta.value+'" längd:',ta.value.length);if(ta.value.length<5){const set=Object.getOwnPropertyDescriptor(HTMLTextAreaElement.prototype,'value').set;set.call(ta,'Rosita');ta.dispatchEvent(new Event('input',{bubbles:true}));ta.dispatchEvent(new Event('change',{bubbles:true}));ta.dispatchEvent(new Event('blur',{bubbles:true}));console.log('Fyllde i kommentar för',dateText);await new Promise(r=>setTimeout(r,1000));const okBtn=[...document.querySelectorAll('[data-automation-id="wd-CommandButton"]')].find(b=>b.textContent.trim()==='OK');if(okBtn){console.log('Klickar OK');okBtn.click();processedEventIndexes.add(i);await new Promise(r=>setTimeout(r,2500));return true;}}else{console.log('Har redan kommentar för event',i);processedEventIndexes.add(i);}}else{console.log('Ingen textarea för event',i);processedEventIndexes.add(i);}}}return false;}let count=0;while(await processNext()){count++;console.log('=== Sparade '+count+' ===');if(count>10)break;}console.log('*** KLAR! Fyllde i '+count+' kommentarer ***');})();